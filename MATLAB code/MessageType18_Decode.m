function [Output] = MessageType18_Decode(Type18)
%% ==============================================================
% Objective: To convert the message types 18 to the ionospheric grid point masks (A.4.4.9 of RTCA DO-229).
% Example: [Output] = MessageType18_Decode(Type18).
% Type18 is an input as the Hex number in the string type (cell size 1x1).
% Output is a structure data type as the matrix of double values.
% CSSRG-LAB of KMITL, Thailand.
% Version 1 by Somkit Sophan (March 2019).
%% ==============================================================
% ===== Ionosperic mask BANDs =====
Lat28U = [-75:10:-55 -50:5:50 55:10:85]; % Latitude 28-indexs as -75 to 85
Lat28D = [-85:10:-55 -50:5:50 55:10:75]; % Latitude 28-indexs as -85 to 75
Lat27 = [-75:10:-55 -50:5:50 55:10:75];  % Latitude 27-indexs as -75 to 75
Lat23 = -55:5:55;       % Latitude 23-indexs as -55 to 55
Lon72 = -180:5:175;     % Longitude 72-indexs as -180 to 175
Lon36 = -180:10:170;    % Longitude 36-indexs as -180 to 170
Lon12L = -180:30:150;   % Longitude 12-indexs as -180 to 150
Lon12R = -170:30:160;   % Longitude 12-indexs as -170 to 160
% ===== Band 0 to 10 =====
Lon_Band0 = -180:5:-145;
Lon_Band1 = -140:5:-105;
Lon_Band2 = -100:5:-65;
Lon_Band3 = -60:5:-25;
Lon_Band4 = -20:5:15;
Lon_Band5 = 20:5:55;
Lon_Band6 = 60:5:95;
Lon_Band7 = 100:5:135;
Lon_Band8 = 140:5:175;
Lat_Band9 = [60:5:75 85];
Lat_Band10 = [-60:-5:-75 -85];
Lat_Band = NaN(1,201);
Lon_Band = NaN(1,201);
% ========================
Char_hex = char(Type18)';   % A cell array of character vectors to a row of the character array
Bin = dec2bin(hex2dec(Char_hex),4)';
Temp = Bin(:)';
Output.Band_numb = bin2dec(Temp(15:18));	% Number of Bands being broadcast
Band =  bin2dec(Temp(19:22));	% Band Number
Output.Band = Band;
Output.IODI = bin2dec(Temp(23:24));	% IODI (Issue of Data-Ionosphere) status
% ===== Decoding the IGP Mask of each band =====
if Band == 0
    Index = find(Temp(25:52)>48);
    Lat_Band(Index) = Lat28U(Index);
    Lon_Band(Index) = Lon_Band0(1);
    Index = find(Temp(53:75)>48);
    Lat_Band(Index+28) = Lat23(Index);
    Lon_Band(Index+28) = Lon_Band0(2);
    Index = find(Temp(76:102)>48);
    Lat_Band(Index+28+23) = Lat27(Index);
    Lon_Band(Index+28+23) = Lon_Band0(3);
    Index = find(Temp(103:125)>48);
    Lat_Band(Index+28+23+27) = Lat23(Index);
    Lon_Band(Index+28+23+27) = Lon_Band0(4);
    Index = find(Temp(126:152)>48);
    Lat_Band(Index+28+23+27+23) = Lat27(Index);
    Lon_Band(Index+28+23+27+23) = Lon_Band0(5);
    Index = find(Temp(153:175)>48);
    Lat_Band(Index+28+23+27+23+27) = Lat23(Index);
    Lon_Band(Index+28+23+27+23+27) = Lon_Band0(6);
    Index = find(Temp(176:202)>48);
    Lat_Band(Index+28+23+27+23+27+23) = Lat27(Index);
    Lon_Band(Index+28+23+27+23+27+23) = Lon_Band0(7);
    Index = find(Temp(203:225)>48);
    Lat_Band(Index+28+23+27+23+27+23+27) = Lat23(Index);
    Lon_Band(Index+28+23+27+23+27+23+27) = Lon_Band0(8);
elseif Band == 1
    Index = find(Temp(25:52)>48);
    Lat_Band(Index) = Lat28D(Index);
    Lon_Band(Index) = Lon_Band1(1);
    Index = find(Temp(53:75)>48);
    Lat_Band(Index+28) = Lat23(Index);
    Lon_Band(Index+28) = Lon_Band1(2);
    Index = find(Temp(76:102)>48);
    Lat_Band(Index+28+23) = Lat27(Index);
    Lon_Band(Index+28+23) = Lon_Band1(3);
    Index = find(Temp(103:125)>48);
    Lat_Band(Index+28+23+27) = Lat23(Index);
    Lon_Band(Index+28+23+27) = Lon_Band1(4);
    Index = find(Temp(126:152)>48);
    Lat_Band(Index+28+23+27+23) = Lat27(Index);
    Lon_Band(Index+28+23+27+23) = Lon_Band1(5);
    Index = find(Temp(153:175)>48);
    Lat_Band(Index+28+23+27+23+27) = Lat23(Index);
    Lon_Band(Index+28+23+27+23+27) = Lon_Band1(6);
    Index = find(Temp(176:202)>48);
    Lat_Band(Index+28+23+27+23+27+23) = Lat27(Index);
    Lon_Band(Index+28+23+27+23+27+23) = Lon_Band1(7);
    Index = find(Temp(203:225)>48);
    Lat_Band(Index+28+23+27+23+27+23+27) = Lat23(Index);
    Lon_Band(Index+28+23+27+23+27+23+27) = Lon_Band1(8);
elseif Band == 2
    Index = find(Temp(25:51)>48);
    Lat_Band(Index) = Lat27(Index);
    Lon_Band(Index) = Lon_Band2(1);
    Index = find(Temp(52:74)>48);
    Lat_Band(Index+27) = Lat23(Index);
    Lon_Band(Index+27) = Lon_Band2(2);
    Index = find(Temp(75:102)>48);
    Lat_Band(Index+27+23) = Lat28U(Index);
    Lon_Band(Index+27+23) = Lon_Band2(3);
    Index = find(Temp(103:125)>48);
    Lat_Band(Index+27+23+28) = Lat23(Index);
    Lon_Band(Index+27+23+28) = Lon_Band2(4);
    Index = find(Temp(126:152)>48);
    Lat_Band(Index+27+23+28+23) = Lat27(Index);
    Lon_Band(Index+27+23+28+23) = Lon_Band2(5);
    Index = find(Temp(153:175)>48);
    Lat_Band(Index+27+23+28+23+27) = Lat23(Index);
    Lon_Band(Index+27+23+28+23+27) = Lon_Band2(6);
    Index = find(Temp(176:202)>48);
    Lat_Band(Index+27+23+28+23+27+23) = Lat27(Index);
    Lon_Band(Index+27+23+28+23+27+23) = Lon_Band2(7);
    Index = find(Temp(203:225)>48);
    Lat_Band(Index+27+23+28+23+27+23+27) = Lat23(Index);
    Lon_Band(Index+27+23+28+23+27+23+27) = Lon_Band2(8);
elseif Band == 3
    Index = find(Temp(25:51)>48);
    Lat_Band(Index) = Lat27(Index);
    Lon_Band(Index) = Lon_Band3(1);
    Index = find(Temp(52:74)>48);
    Lat_Band(Index+27) = Lat23(Index);
    Lon_Band(Index+27) = Lon_Band3(2);
    Index = find(Temp(75:102)>48);
    Lat_Band(Index+27+23) = Lat28D(Index);
    Lon_Band(Index+27+23) = Lon_Band3(3);
    Index = find(Temp(103:125)>48);
    Lat_Band(Index+27+23+28) = Lat23(Index);
    Lon_Band(Index+27+23+28) = Lon_Band3(4);
    Index = find(Temp(126:152)>48);
    Lat_Band(Index+27+23+28+23) = Lat27(Index);
    Lon_Band(Index+27+23+28+23) = Lon_Band3(5);
    Index = find(Temp(153:175)>48);
    Lat_Band(Index+27+23+28+23+27) = Lat23(Index);
    Lon_Band(Index+27+23+28+23+27) = Lon_Band3(6);
    Index = find(Temp(176:202)>48);
    Lat_Band(Index+27+23+28+23+27+23) = Lat27(Index);
    Lon_Band(Index+27+23+28+23+27+23) = Lon_Band3(7);
    Index = find(Temp(203:225)>48);
    Lat_Band(Index+27+23+28+23+27+23+27) = Lat23(Index);
    Lon_Band(Index+27+23+28+23+27+23+27) = Lon_Band3(8);
elseif Band == 4
    Index = find(Temp(25:51)>48);
    Lat_Band(Index) = Lat27(Index);
    Lon_Band(Index) = Lon_Band4(1);
    Index = find(Temp(52:74)>48);
    Lat_Band(Index+27) = Lat23(Index);
    Lon_Band(Index+27) = Lon_Band4(2);
    Index = find(Temp(75:101)>48);
    Lat_Band(Index+27+23) = Lat27(Index);
    Lon_Band(Index+27+23) = Lon_Band4(3);
    Index = find(Temp(102:124)>48);
    Lat_Band(Index+27+23+27) = Lat23(Index);
    Lon_Band(Index+27+23+27) = Lon_Band4(4);
    Index = find(Temp(125:152)>48);
    Lat_Band(Index+27+23+27+23) = Lat28U(Index);
    Lon_Band(Index+27+23+27+23) = Lon_Band4(5);
    Index = find(Temp(153:175)>48);
    Lat_Band(Index+27+23+27+23+28) = Lat23(Index);
    Lon_Band(Index+27+23+27+23+28) = Lon_Band4(6);
    Index = find(Temp(176:202)>48);
    Lat_Band(Index+27+23+27+23+28+23) = Lat27(Index);
    Lon_Band(Index+27+23+27+23+28+23) = Lon_Band4(7);
    Index = find(Temp(203:225)>48);
    Lat_Band(Index+27+23+27+23+28+23+27) = Lat23(Index);
    Lon_Band(Index+27+23+27+23+28+23+27) = Lon_Band4(8);
elseif Band == 5
    Index = find(Temp(25:51)>48);
    Lat_Band(Index) = Lat27(Index);
    Lon_Band(Index) = Lon_Band5(1);
    Index = find(Temp(52:74)>48);
    Lat_Band(Index+27) = Lat23(Index);
    Lon_Band(Index+27) = Lon_Band5(2);
    Index = find(Temp(75:101)>48);
    Lat_Band(Index+27+23) = Lat27(Index);
    Lon_Band(Index+27+23) = Lon_Band5(3);
    Index = find(Temp(102:124)>48);
    Lat_Band(Index+27+23+27) = Lat23(Index);
    Lon_Band(Index+27+23+27) = Lon_Band5(4);
    Index = find(Temp(125:152)>48);
    Lat_Band(Index+27+23+27+23) = Lat28D(Index);
    Lon_Band(Index+27+23+27+23) = Lon_Band5(5);
    Index = find(Temp(153:175)>48);
    Lat_Band(Index+27+23+27+23+28) = Lat23(Index);
    Lon_Band(Index+27+23+27+23+28) = Lon_Band5(6);
    Index = find(Temp(176:202)>48);
    Lat_Band(Index+27+23+27+23+28+23) = Lat27(Index);
    Lon_Band(Index+27+23+27+23+28+23) = Lon_Band5(7);
    Index = find(Temp(203:225)>48);
    Lat_Band(Index+27+23+27+23+28+23+27) = Lat23(Index);
    Lon_Band(Index+27+23+27+23+28+23+27) = Lon_Band5(8);
elseif Band == 6
    Index = find(Temp(25:51)>48);
    Lat_Band(Index) = Lat27(Index);
    Lon_Band(Index) = Lon_Band6(1);
    Index = find(Temp(52:74)>48);
    Lat_Band(Index+27) = Lat23(Index);
    Lon_Band(Index+27) = Lon_Band6(2);
    Index = find(Temp(75:101)>48);
    Lat_Band(Index+27+23) = Lat27(Index);
    Lon_Band(Index+27+23) = Lon_Band6(3);
    Index = find(Temp(102:124)>48);
    Lat_Band(Index+27+23+27) = Lat23(Index);
    Lon_Band(Index+27+23+27) = Lon_Band6(4);
    Index = find(Temp(125:151)>48);
    Lat_Band(Index+27+23+27+23) = Lat27(Index);
    Lon_Band(Index+27+23+27+23) = Lon_Band6(5);
    Index = find(Temp(152:174)>48);
    Lat_Band(Index+27+23+27+23+27) = Lat23(Index);
    Lon_Band(Index+27+23+27+23+27) = Lon_Band6(6);
    Index = find(Temp(175:202)>48);
    Lat_Band(Index+27+23+27+23+27+23) = Lat28U(Index);
    Lon_Band(Index+27+23+27+23+27+23) = Lon_Band6(7);
    Index = find(Temp(203:225)>48);
    Lat_Band(Index+27+23+27+23+27+23+28) = Lat23(Index);
    Lon_Band(Index+27+23+27+23+27+23+28) = Lon_Band6(8);
elseif Band == 7
    Index = find(Temp(25:51)>48);
    Lat_Band(Index) = Lat27(Index);
    Lon_Band(Index) = Lon_Band7(1);
    Index = find(Temp(52:74)>48);
    Lat_Band(Index+27) = Lat23(Index);
    Lon_Band(Index+27) = Lon_Band7(2);
    Index = find(Temp(75:101)>48);
    Lat_Band(Index+27+23) = Lat27(Index);
    Lon_Band(Index+27+23) = Lon_Band7(3);
    Index = find(Temp(102:124)>48);
    Lat_Band(Index+27+23+27) = Lat23(Index);
    Lon_Band(Index+27+23+27) = Lon_Band7(4);
    Index = find(Temp(125:151)>48);
    Lat_Band(Index+27+23+27+23) = Lat27(Index);
    Lon_Band(Index+27+23+27+23) = Lon_Band7(5);
    Index = find(Temp(152:174)>48);
    Lat_Band(Index+27+23+27+23+27) = Lat23(Index);
    Lon_Band(Index+27+23+27+23+27) = Lon_Band7(6);
    Index = find(Temp(175:202)>48);
    Lat_Band(Index+27+23+27+23+27+23) = Lat28D(Index);
    Lon_Band(Index+27+23+27+23+27+23) = Lon_Band7(7);
    Index = find(Temp(203:225)>48);
    Lat_Band(Index+27+23+27+23+27+23+28) = Lat23(Index);
    Lon_Band(Index+27+23+27+23+27+23+28) = Lon_Band7(8);
elseif Band == 8
    Index = find(Temp(25:51)>48);
    Lat_Band(Index) = Lat27(Index);
    Lon_Band(Index) = Lon_Band8(1);
    Index = find(Temp(52:74)>48);
    Lat_Band(Index+27) = Lat23(Index);
    Lon_Band(Index+27) = Lon_Band8(2);
    Index = find(Temp(75:101)>48);
    Lat_Band(Index+27+23) = Lat27(Index);
    Lon_Band(Index+27+23) = Lon_Band8(3);
    Index = find(Temp(102:124)>48);
    Lat_Band(Index+27+23+27) = Lat23(Index);
    Lon_Band(Index+27+23+27) = Lon_Band8(4);
    Index = find(Temp(125:151)>48);
    Lat_Band(Index+27+23+27+23) = Lat27(Index);
    Lon_Band(Index+27+23+27+23) = Lon_Band8(5);
    Index = find(Temp(152:174)>48);
    Lat_Band(Index+27+23+27+23+27) = Lat23(Index);
    Lon_Band(Index+27+23+27+23+27) = Lon_Band8(6);
    Index = find(Temp(175:201)>48);
    Lat_Band(Index+27+23+27+23+27+23) = Lat27(Index);
    Lon_Band(Index+27+23+27+23+27+23) = Lon_Band8(7);
    Index = find(Temp(202:224)>48);
    Lat_Band(Index+27+23+27+23+27+23+27) = Lat23(Index);
    Lon_Band(Index+27+23+27+23+27+23+27) = Lon_Band8(8);
elseif Band == 9
    Index = find(Temp(25:96)>48);
    Lat_Band(Index) = Lat_Band9(1);
    Lon_Band(Index) = Lon72(Index);
    Index = find(Temp(97:132)>48);
    Lat_Band(Index+72) = Lat_Band9(2);
    Lon_Band(Index+72) = Lon36(Index);
    Index = find(Temp(133:168)>48);
    Lat_Band(Index+72+36) = Lat_Band9(3);
    Lon_Band(Index+72+36) = Lon36(Index);
    Index = find(Temp(169:204)>48);
    Lat_Band(Index+72+36+36) = Lat_Band9(4);
    Lon_Band(Index+72+36+36) = Lon36(Index);
    Index = find(Temp(205:216)>48);
    Lat_Band(Index+72+36+36+36) = Lat_Band9(5);
    Lon_Band(Index+72+36+36+36) = Lon12L(Index);
elseif Band == 10
    Index = find(Temp(25:96)>48);
    Lat_Band(Index) = Lat_Band10(1);
    Lon_Band(Index) = Lon72(Index);
    Index = find(Temp(97:132)>48);
    Lat_Band(Index+72) = Lat_Band10(2);
    Lon_Band(Index+72) = Lon36(Index);
    Index = find(Temp(133:168)>48);
    Lat_Band(Index+72+36) = Lat_Band10(3);
    Lon_Band(Index+72+36) = Lon36(Index);
    Index = find(Temp(169:204)>48);
    Lat_Band(Index+72+36+36) = Lat_Band10(4);
    Lon_Band(Index+72+36+36) = Lon36(Index);
    Index = find(Temp(205:216)>48);
    Lat_Band(Index+72+36+36+36) = Lat_Band10(5);
    Lon_Band(Index+72+36+36+36) = Lon12R(Index);
end
Output.Lat = Lat_Band;
Output.Lon = Lon_Band;
clear Temp
